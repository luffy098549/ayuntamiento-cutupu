<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - Ayuntamiento de Cutup√∫</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/static.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/perfil.css') }}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/favicon.ico') }}">
</head>
<body>
    <!-- HEADER (mismo que index.html) -->
    <header class="header">
        <div class="header-container">
            <div class="header-izquierda">
                <a href="/" class="logo-principal" aria-label="Ir a la p√°gina de inicio">
                    <img src="{{ url_for('static', filename='img/WhatsApp Image 2026-02-06 at 7.37.02 PM.jpeg') }}" 
                         alt="Logo del Ayuntamiento de Cutup√∫"
                         class="logo-icono"
                         width="50"
                         height="50">
                    <div class="logo-texto">
                        Ayuntamiento de Cutup√∫
                        <span class="logo-subtitulo">Gesti√≥n municipal</span>
                    </div>
                </a>
            </div>

            <nav class="nav-principal" aria-label="Navegaci√≥n principal">
                <button class="btn-menu-movil" aria-expanded="false" aria-controls="menu-principal" aria-label="Abrir men√∫ de navegaci√≥n">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <ul class="nav-lista" id="menu-principal">
                    <li class="nav-item">
                        <a href="/" class="nav-enlace">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a href="/servicios" class="nav-enlace">Servicios</a>
                    </li>
                    <li class="nav-item">
                        <a href="/nosotros" class="nav-enlace">Nosotros</a>
                    </li>
                    <li class="nav-item">
                        <a href="/avisos" class="nav-enlace">Avisos</a>
                    </li>
                    <li class="nav-item">
                        <a href="/transparencia" class="nav-enlace">Transparencia</a>
                    </li>
                    <li class="nav-item">
                        <a href="/proyectos" class="nav-enlace">Proyectos</a>
                    </li>
                    <li class="nav-item">
                        <a href="/contacto" class="nav-enlace">Contacto</a>
                    </li>
                    
                    {% if current_user.is_authenticated %}
                    <li class="nav-item nav-item-movil">
                        <a href="/perfil" class="nav-enlace">Mi Perfil</a>
                    </li>
                    <li class="nav-item nav-item-movil">
                        <a href="/logout" class="nav-enlace">Cerrar Sesi√≥n</a>
                    </li>
                    {% endif %}
                </ul>
            </nav>

            <div class="header-derecha">
                <a href="https://www.gob.do/" class="logo-rd" target="_blank" rel="noopener noreferrer"
                   aria-label="Visitar p√°gina del Gobierno de la Rep√∫blica Dominicana">
                    <img src="{{ url_for('static', filename='img/Escudo-de-Republica-Dominicana-1024x1019.png') }}" 
                         alt="Escudo de la Rep√∫blica Dominicana"
                         width="45"
                         height="45">
                    <span class="logo-rd-texto">Rep√∫blica<br>Dominicana</span>
                </a>

                <div class="separador-vertical"></div>

                <div class="dropdown-perfil">
                    <button class="btn-perfil" aria-label="Men√∫ de perfil" aria-expanded="false">
                        <div class="avatar-usuario">
                            <div class="avatar-iniciales">
                                {{ current_user.nombre[0] if current_user and current_user.nombre else 'U' }}
                            </div>
                        </div>
                        <span class="nombre-usuario">{{ current_user.nombre if current_user and current_user.nombre else (current_user.email if current_user else 'Usuario') }}</span>
                        <span class="dropdown-icon">‚ñº</span>
                    </button>
                    <div class="dropdown-menu">
                        <a href="/perfil" class="dropdown-item">
                            <span class="dropdown-icon">üë§</span>
                            Mi Perfil
                        </a>
                        <a href="/servicios" class="dropdown-item">
                            <span class="dropdown-icon">üîß</span>
                            Servicios
                        </a>
                        <a href="/logout" class="dropdown-item">
                            <span class="dropdown-icon">üö™</span>
                            Cerrar Sesi√≥n
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- CONTENIDO PRINCIPAL DEL PERFIL -->
    <main class="contenido-principal perfil-container">
        <div class="perfil-wrapper">
            <!-- Sidebar de navegaci√≥n -->
            <aside class="perfil-sidebar">
                <div class="perfil-resumen">
                    <div class="perfil-avatar">
                        <div class="avatar-grande">
                            {{ current_user.nombre[0] if current_user and current_user.nombre else 'U' }}
                        </div>
                        <button class="btn-cambiar-foto" onclick="document.getElementById('file-input').click()">
                            üì∑ Cambiar
                        </button>
                        <input type="file" id="file-input" accept="image/*" style="display: none;">
                    </div>
                    <h2 class="perfil-nombre">{{ current_user.nombre if current_user and current_user.nombre else 'Usuario' }}</h2>
                    <p class="perfil-email">{{ current_user.email if current_user else '' }}</p>
                    <div class="perfil-stats">
        
                    </div>
                </div>

                <nav class="perfil-menu">
                    <a href="#informacion" class="menu-item activo" data-target="informacion">
                        <span class="menu-icon">üë§</span>
                        Informaci√≥n Personal
                    </a>
                    <a href="#seguridad" class="menu-item" data-target="seguridad">
                        <span class="menu-icon">üîí</span>
                        Seguridad
                    </a>
                    <a href="/servicios" class="menu-item">
                        <span class="menu-icon">üìã</span>
                        Solicitar Servicios
                    </a>
                    <a href="#reportes" class="menu-item" data-target="reportes">
                        <span class="menu-icon">üö®</span>
                        Hacer Reportes
                    </a>
                    <a href="#denuncias" class="menu-item" data-target="denuncias">
                        <span class="menu-icon">‚öñÔ∏è</span>
                        Presentar Denuncias
                    </a>
                    <a href="#mis-tramites" class="menu-item" data-target="mis-tramites">
                        <span class="menu-icon">üìã</span>
                        Mis Tr√°mites
                    </a>
                </nav>
            </aside>

            <!-- Contenido principal del perfil -->
            <div class="perfil-contenido">
                <!-- Secci√≥n Informaci√≥n Personal -->
                <section id="informacion" class="perfil-seccion activa">
                    <h2 class="seccion-titulo">Informaci√≥n Personal</h2>
                    
                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                                <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }}">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
                    
                    <form class="perfil-form" method="POST" action="{{ url_for('actualizar_perfil') }}">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nombre">Nombre Completo</label>
                                <input type="text" id="nombre" name="nombre" 
                                       value="{{ current_user.nombre if current_user and current_user.nombre else '' }}"
                                       placeholder="Ingresa tu nombre completo" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="telefono">Tel√©fono</label>
                                <input type="tel" id="telefono" name="telefono" 
                                       value="{{ current_user.telefono if current_user else '' }}"
                                       placeholder="(000) 000-0000">
                            </div>
                            
                            <div class="form-group">
                                <label for="direccion">Direcci√≥n</label>
                                <input type="text" id="direccion" name="direccion" 
                                       value="{{ current_user.direccion if current_user else '' }}"
                                       placeholder="Calle, n√∫mero, sector">
                            </div>
                            
                            <div class="form-group">
                                <label for="cedula">C√©dula</label>
                                <input type="text" id="cedula" name="cedula" 
                                       value="{{ current_user.cedula if current_user else '' }}"
                                       placeholder="000-0000000-0">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="email">Correo Electr√≥nico</label>
                            <input type="email" id="email" value="{{ current_user.email if current_user else '' }}" disabled>
                            <small class="form-text">Para cambiar el correo, contacta con administraci√≥n</small>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn-guardar">
                                üíæ Guardar Cambios
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Secci√≥n Seguridad -->
                <section id="seguridad" class="perfil-seccion">
                    <h2 class="seccion-titulo">Seguridad y Contrase√±a</h2>
                    
                    <form class="perfil-form" method="POST" action="{{ url_for('cambiar_contrasena') }}">
                        <div class="form-group">
                            <label for="contrasena_actual">Contrase√±a Actual</label>
                            <input type="password" id="contrasena_actual" name="contrasena_actual" 
                                   placeholder="Ingresa tu contrase√±a actual" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="nueva_contrasena">Nueva Contrase√±a</label>
                            <input type="password" id="nueva_contrasena" name="nueva_contrasena" 
                                   placeholder="M√≠nimo 8 caracteres" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmar_contrasena">Confirmar Contrase√±a</label>
                            <input type="password" id="confirmar_contrasena" name="confirmar_contrasena" 
                                   placeholder="Repite la nueva contrase√±a" required>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn-guardar">
                                üîê Cambiar Contrase√±a
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Secci√≥n Reportes -->
                <section id="reportes" class="perfil-seccion">
                    <h2 class="seccion-titulo">Reportar Problemas</h2>
                    <p class="seccion-descripcion">Reporta problemas en tu comunidad para que los solucionemos.</p>
                    
                    <div class="reportes-grid">
                        <div class="reporte-categoria">
                            <h3>üîß Problemas de Infraestructura</h3>
                            <p>Reportar baches, alumbrado p√∫blico, se√±alizaci√≥n, etc.</p>
                            <a href="{{ url_for('reportar', tipo='infraestructura') }}" class="btn-reportar">
                                Reportar Ahora
                            </a>
                        </div>
                        
                        <div class="reporte-categoria">
                            <h3>üöÆ Problemas de Limpieza</h3>
                            <p>Basura acumulada, recolecci√≥n, maleza, etc.</p>
                            <a href="{{ url_for('reportar', tipo='limpieza') }}" class="btn-reportar">
                                Reportar Ahora
                            </a>
                        </div>
                        
                        <div class="reporte-categoria">
                            <h3>‚ö†Ô∏è Emergencias y Peligros</h3>
                            <p>√Årboles ca√≠dos, cables sueltos, inundaciones, etc.</p>
                            <a href="{{ url_for('reportar', tipo='emergencias') }}" class="btn-reportar">
                                Reportar Ahora
                            </a>
                        </div>
                    </div>
                </section>

                <!-- Secci√≥n Denuncias -->
                <section id="denuncias" class="perfil-seccion">
                    <h2 class="seccion-titulo">Presentar Denuncias</h2>
                    <p class="seccion-descripcion">Denuncias formales que requieren acci√≥n legal o administrativa.</p>
                    
                    <div class="tipos-denuncia">
                        <div class="tipo-denuncia">
                            <h4>üèóÔ∏è Construcciones Irregulares</h4>
                            <p>Denunciar construcciones sin permiso o que violen normativas.</p>
                            <a href="{{ url_for('denunciar', tipo='construccion') }}" class="btn-denunciar">
                                Presentar Denuncia
                            </a>
                        </div>
                        
                        <div class="tipo-denuncia">
                            <h4>üì¢ Ruidos Molestos</h4>
                            <p>Denunciar ruido excesivo en horas no permitidas.</p>
                            <a href="{{ url_for('denunciar', tipo='ruidos') }}" class="btn-denunciar">
                                Presentar Denuncia
                            </a>
                        </div>
                        
                        <div class="tipo-denuncia">
                            <h4>üö´ Incumplimiento de Normas</h4>
                            <p>Denunciar violaciones a ordenanzas municipales.</p>
                            <a href="{{ url_for('denunciar', tipo='normas') }}" class="btn-denunciar">
                                Presentar Denuncia
                            </a>
                        </div>
                    </div>
                </section>

                <!-- Secci√≥n Mis Tr√°mites -->
                <section id="mis-tramites" class="perfil-seccion">
                    <h2 class="seccion-titulo">Mis Tr√°mites y Solicitudes</h2>
                    
                    <div class="tramites-container">
                        <div class="tramites-header">
                            <div class="tramites-filtros">
                                <button class="filtro-btn activo">Todos</button>
                                <button class="filtro-btn">Pendientes</button>
                                <button class="filtro-btn">En Proceso</button>
                                <button class="filtro-btn">Completados</button>
                            </div>
                            <a href="/servicios" class="btn-nuevo-tramite">
                                + Nuevo Tr√°mite
                            </a>
                        </div>
                        
                        <div class="tramites-lista">
                            <div class="tramite-vacio">
                                <p>No tienes tr√°mites registrados a√∫n.</p>
                                <a href="/servicios" class="btn-primario">Ir a Servicios</a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="footer footer-horizontal" aria-label="Pie de p√°gina">
        <div class="footer-superior">
            <div class="footer-contenido-horizontal">
                <!-- Logo y Descripci√≥n -->
                <div class="footer-logo-descripcion">
                    <a href="/" class="footer-logo" aria-label="Volver al inicio">
                        <img src="{{ url_for('static', filename='img/WhatsApp Image 2026-02-06 at 7.37.02 PM.jpeg') }}" 
                             alt="Logo del Ayuntamiento de Cutup√∫"
                             class="footer-logo-img"
                             width="50"
                             height="50">
                        <div>
                            <h3 class="footer-titulo-logo">Ayuntamiento de Cutup√∫</h3>
                            <p class="footer-subtitulo-logo">Gesti√≥n Municipal</p>
                        </div>
                    </a>
                    <p class="footer-descripcion-corta">
                        Comprometidos con el desarrollo y bienestar de nuestra comunidad.
                    </p>
                </div>

                <!-- Enlaces y Redes -->
                <div class="footer-enlaces-redes">
                    <!-- Enlaces r√°pidos -->
                    <div class="footer-enlaces-rapidos">
                        <h4 class="footer-subtitulo">Enlaces r√°pidos</h4>
                        <div class="enlaces-grid">
                            <a href="/servicios" class="enlace-rapido">Servicios</a>
                            <a href="/avisos" class="enlace-rapido">Avisos</a>
                            <a href="/transparencia" class="enlace-rapido">Transparencia</a>
                            <a href="/proyectos" class="enlace-rapido">Proyectos</a>
                            <a href="/contacto" class="enlace-rapido">Contacto</a>
                            <a href="/nosotros" class="enlace-rapido">Nosotros</a>
                            <a href="/perfil" class="enlace-rapido">Mi Perfil</a>
                        </div>
                    </div>

                    <!-- Redes Sociales y Contacto -->
                    <div class="footer-redes-contacto">
                        <div class="footer-redes-sociales">
                            <h4 class="footer-subtitulo">S√≠guenos</h4>
                            <div class="redes-iconos">
                                <a href="https://www.facebook.com/ayuntamientocutupu?locale=es_LA" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   class="redes-icono facebook"
                                   aria-label="Facebook">
                                    <span>f</span>
                                </a>
                                <a href="https://www.instagram.com/juntamunicipalvillacutupu0107/" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   class="redes-icono instagram"
                                   aria-label="Instagram">
                                    <span>ig</span>
                                </a>
                                <a href="https://www.youtube.com/results?search_query=ayuntamiento+de+cutupu" 
                                   target="_blank" 
                                   rel="noopener noreferrer"
                                   class="redes-icono youtube"
                                   aria-label="YouTube">
                                    <span>yt</span>
                                </a>
                            </div>
                        </div>

                        <!-- Email -->
                        <div class="footer-contacto-email">
                            <h4 class="footer-subtitulo">Contacto</h4>
                            <a href="mailto:juntamunicipalrioverdearriba@gmail.com" 
                               class="footer-email"
                               aria-label="Enviar email">
                                üìß juntamunicipalrioverdearriba@gmail.com
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- L√≠nea separadora -->
        <div class="footer-separador"></div>

        <!-- Base del footer -->
        <div class="footer-base-horizontal">
            <div class="footer-base-contenido">
                <!-- Derechos -->
                <div class="footer-derechos">
                    <span class="footer-copy">¬©</span>
                    <span id="anio-actual">{{ now.year if now else "2026" }}</span>
                    Ayuntamiento Municipal de Cutup√∫ ¬∑ Todos los derechos reservados
                </div>

                <!-- Aviso legal -->
                <div class="footer-aviso-legal-corto">
                    <span class="aviso-icono">üìö</span>
                    Aviso Legal: Sitio educativo - No oficial - Libre de derechos
                </div>

                <!-- Seguridad -->
                <div class="footer-seguridad">
                    <span class="seguridad-icono">üîí</span>
                    Sitio seguro | 
                    <span class="educativo-icono">üìñ</span>
                    Proyecto educativo
                </div>
            </div>
        </div>
    </footer>

 
    <script src="{{ url_for('static', filename='js/perfil.js') }}"></script>
</body>
</html>